(function(){"use strict";var e={2153:function(e,t,n){n(6992),n(8674),n(7727);var a=n(9242),o=n(3396);const i={class:"wrapper"},s=(0,o._)("div",{id:"map"},null,-1);function r(e,t,n,a,r,l){const c=(0,o.up)("sidebar-component"),u=(0,o.up)("search-component"),p=(0,o.up)("router-view");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("div",i,[(0,o.Wm)(c),s,(0,o.Wm)(u)]),(0,o.Wm)(p),(0,o.Wm)(u)])}var l=n(4648),c=n(3153),u=n.n(c),p=(n(4954),n.p+"img/more-icon.a845dd2d.svg"),d=n.p+"img/average-icon.70f0d8e8.svg",m=n.p+"img/less-icon.1f715939.svg",f=n.p+"img/soldout-icon.98aedc76.svg";function v(){return{green:p,yellow:d,red:m,gray:f}}var h=n(3766),y=n(3131);let g={},k={},b={};function _(){g=u().map("map",{center:[24.052137,120.555235],zoom:8,zoomControl:!1}),u().tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:20}).addTo(g),k=new(u().MarkerClusterGroup)({spiderfyOnMaxZoom:!0,showCoverageOnHover:!1,zoomToBoundsOnClick:!0}).addTo(g)}function w(){const e=function(e){let t=e.coords.latitude,n=e.coords.longitude;C([t,n])},t=function(){},n={maximumAge:6e4,timeout:45e3};navigator.geolocation.getCurrentPosition(e,t,n)}function C(e){const t=(0,y.v)(),{slidebar:n}=(0,h.Jk)(t);n.value=!0,g.panTo(e).setView(e,19)}function x(e){setTimeout((()=>{b[e].openPopup()}),300)}function D(e){const{greenIcon:t,yellowIcon:n,redIcon:a,greyIcon:o}=z();e.forEach(((e,i)=>{let s=e.properties.mask_adult+e.properties.mask_child,r={};r=s>=1500?t:s>=750?n:s>=1?a:o;let l=u().marker(e.geometry.coordinates,{icon:r}).bindPopup(`\n      <h3>${e.properties.name}</h3>\n      <p>地址: ${e.properties.address}</p>\n      <p>電話: ${e.properties.phone}</p>\n      <p>成人口罩數量: ${e.properties.mask_adult}</p>\n      <p>兒童口罩數量: ${e.properties.mask_child}</p>\n    `);k.addLayer(l),b[i]=l}))}function T(e){const{greenIcon:t,yellowIcon:n,redIcon:a,greyIcon:o}=z();e.forEach(((e,i)=>{let s={};s=e.stock>=80?t:e.stock>=30?n:e.stock>=1?a:o;let r=u().marker([e.latitude,e.longitude],{icon:s}).bindPopup(`\n      <h3>${e.name}</h3>\n      <p>地址: ${e.address}</p>\n      <p>電話: ${e.telephone}</p>\n      <p>快篩試劑數量: ${e.stock}</p>\n    `);k.addLayer(r),b[i]=r}))}function U(){b={},k.clearLayers()}function z(){const{green:e,yellow:t,red:n,gray:a}=v(),o={iconSize:[30,41],iconAnchor:[12,41],popupAnchor:[4,-34],shadowSize:[45,45]},i=new(u().Icon)((0,l.Z)({iconUrl:e},o)),s=new(u().Icon)((0,l.Z)({iconUrl:t},o)),r=new(u().Icon)((0,l.Z)({iconUrl:n},o)),c=new(u().Icon)((0,l.Z)({iconUrl:a},o));return{greenIcon:i,yellowIcon:s,redIcon:r,grayIcon:c}}var O=n(7139),$=n.p+"img/doctor-icon.cc3bc68a.svg";const j={class:"sidebar-header p-3"},P={class:"d-flex row"},q={class:"col-10 d-flex justify-content-between"},I={key:0},M=(0,o._)("h2",null,"快篩地圖",-1),A={key:0,class:"small"},H=(0,o.Uk)("資料更新於:"),Z=(0,o._)("br",null,null,-1),L={class:"col-2"},S=(0,o._)("i",{class:"fa-solid fa-xmark"},null,-1),E=[S],N={class:"d-flex"},W=(0,o._)("img",{src:$,alt:""},null,-1),Y={key:0,class:"h4 text-info mx-3"},B=(0,o.Uk)(" 注意！！"),J=(0,o._)("br",null,null,-1),K=(0,o.Uk)("因為口罩即時資料已停止更新"),V=(0,o._)("br",null,null,-1),F=(0,o.Uk)("本地圖僅供展示 "),G=[B,J,K,V,F],Q={key:1,class:"h4 text-info mx-3"},R=(0,o.Uk)(" 注意！！"),X=(0,o._)("br",null,null,-1),ee=(0,o.Uk)("每次每人限購一份(五劑) "),te=[R,X,ee],ne={class:"mt-3"},ae={type:"button",class:"btn btn-outline-primary rounded-pill col-12","data-toggle":"modal","data-target":"#searchBox"},oe=(0,o._)("i",{class:"fa-solid fa-magnifying-glass"},null,-1),ie={class:"county pl-2"},se={class:"town pl-2"},re={class:"pharmacy-list"},le={key:0},ce={type:"button",class:"btn btn-danger p-2"},ue={key:0},pe=(0,o.Uk)(" 切換至快篩地圖 "),de={key:1},me=(0,o.Uk)(" 切換至口罩地圖 "),fe=(0,o._)("div",null," 側邊欄 ",-1),ve=[fe];function he(e,t,n,a,i,s){const r=(0,o.up)("mask-list-component"),l=(0,o.up)("quick-list-component"),c=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("div",{id:"sidebar",class:(0,O.C_)({active:a.slidebar})},[(0,o._)("div",j,[(0,o._)("div",P,[(0,o._)("div",q,["mask"==a.type?((0,o.wg)(),(0,o.iD)("h2",I,"口罩地圖")):((0,o.wg)(),(0,o.iD)(o.HY,{key:1},[M,0!=a.quickData.length?((0,o.wg)(),(0,o.iD)("small",A,[H,Z,(0,o.Uk)(" "+(0,O.zw)(a.quickData[0].source_time),1)])):(0,o.kq)("",!0)],64))]),(0,o._)("div",L,[(0,o._)("button",{type:"button",class:"btn",onClick:t[0]||(t[0]=e=>a.slidebar=!a.slidebar)},E)])]),(0,o._)("div",N,[W,"mask"==a.type?((0,o.wg)(),(0,o.iD)("p",Y,G)):((0,o.wg)(),(0,o.iD)("p",Q,te))]),(0,o._)("div",ne,[(0,o._)("button",ae,[oe,(0,o._)("span",ie,(0,O.zw)(a.chooseCounty),1),(0,o._)("span",se,(0,O.zw)(a.chooseTown),1)])])]),(0,o._)("div",re,[a.filterData?((0,o.wg)(),(0,o.iD)("ul",le,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.filterData,((e,t)=>((0,o.wg)(),(0,o.iD)("li",{class:"card flex-wrap pt-2",key:t},["mask"==a.type?((0,o.wg)(),(0,o.j4)(r,{key:0,item:e,index:t},null,8,["item","index"])):((0,o.wg)(),(0,o.j4)(l,{key:1,item:e,index:t},null,8,["item","index"]))])))),128))])):(0,o.kq)("",!0)])],2),(0,o._)("div",{class:(0,O.C_)(["sidebar-btn toggle-btn",{active:a.slidebar}])},[(0,o._)("button",ce,[(0,o._)("div",null,["mask"==a.type?((0,o.wg)(),(0,o.iD)("span",ue,[(0,o.Wm)(c,{to:"/quick",onClick:a.changeType},{default:(0,o.w5)((()=>[pe])),_:1},8,["onClick"])])):((0,o.wg)(),(0,o.iD)("span",de,[(0,o.Wm)(c,{to:"/",onClick:a.changeType},{default:(0,o.w5)((()=>[me])),_:1},8,["onClick"])]))])])],2),(0,o._)("div",{class:(0,O.C_)(["sidebar-btn",{active:a.slidebar}])},[(0,o._)("button",{type:"button",class:"btn btn-primary p-2",onClick:t[1]||(t[1]=e=>{a.slidebar=!a.slidebar})},ve)],2)])}var ye=n(4870),ge=n(2483);const ke={class:"col-12 pr-0"},be={class:"d-flex justify-content-between align-items-center"},_e={class:"pharmacy-name text-primary"},we={class:"col-3 d-flex p-0"},Ce=(0,o._)("div",{class:"circle mr-1"},[(0,o._)("i",{class:"fa-solid fa-phone"})],-1),xe=(0,o._)("i",{class:"fa-solid fa-location-dot"},null,-1),De=[xe],Te={class:"pharmacy-phone"},Ue=(0,o._)("i",{class:"fa-solid fa-phone"},null,-1),ze={href:""},Oe=(0,o._)("i",{class:"fa-solid fa-location-dot"},null,-1),$e={class:"pharmacy-note"},je=(0,o._)("i",{class:"fa-solid fa-message"},null,-1),Pe={class:"w-100 d-flex"},qe=(0,o.Uk)(" 成人: "),Ie=(0,o.Uk)(" 兒童: ");function Me(e,t,n,a,i,s){return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",ke,[(0,o._)("div",be,[(0,o._)("p",_e,(0,O.zw)(n.item.properties.name),1),(0,o._)("div",we,[Ce,(0,o._)("div",{class:"circle",onClick:t[0]||(t[0]=e=>{a.moveToPosition(n.item.geometry.coordinates),a.popUpMarker(n.index)})},De)])]),(0,o._)("p",Te,[Ue,(0,o._)("a",ze,(0,O.zw)(n.item.properties.phone),1)]),(0,o._)("p",{class:"pharmacy-address",onClick:t[1]||(t[1]=e=>{a.moveToPosition(n.item.geometry.coordinates),a.popUpMarker(n.index)})},[Oe,(0,o.Uk)(" "+(0,O.zw)(n.item.properties.address),1)]),(0,o._)("p",$e,[je,(0,o.Uk)(" "+(0,O.zw)(n.item.properties.note),1)])]),(0,o._)("div",Pe,[(0,o._)("div",{class:(0,O.C_)(["col-6 pharmacy-box",a.classColor(n.item.properties.mask_adult)])},[qe,(0,o._)("span",null,(0,O.zw)(n.item.properties.mask_adult),1)],2),(0,o._)("div",{class:(0,O.C_)(["col-6 pharmacy-box",a.classColor(n.item.properties.mask_child)])},[Ie,(0,o._)("span",null,(0,O.zw)(n.item.properties.mask_child),1)],2)])],64)}var Ae={name:"maskList",props:["item","index"],setup(){function e(e){let t="";return t=e>=750?"bg-primary":e>=250?"bg-warning":e>=1?"bg-danger":"bg-secondary",t}return{classColor:e,moveToPosition:C,popUpMarker:x}}},He=n(89);const Ze=(0,He.Z)(Ae,[["render",Me]]);var Le=Ze;const Se={class:"col-12 pr-0"},Ee={class:"d-flex justify-content-between align-items-center"},Ne={class:"pharmacy-name text-primary"},We={class:"col-3 d-flex p-0"},Ye=(0,o._)("div",{class:"circle mr-1"},[(0,o._)("i",{class:"fa-solid fa-phone"})],-1),Be=(0,o._)("i",{class:"fa-solid fa-location-dot"},null,-1),Je=[Be],Ke={class:"pharmacy-phone"},Ve=(0,o._)("i",{class:"fa-solid fa-phone"},null,-1),Fe={href:""},Ge=(0,o._)("i",{class:"fa-solid fa-location-dot"},null,-1),Qe={class:"pharmacy-note"},Re=(0,o._)("i",{class:"fa-solid fa-message"},null,-1),Xe={class:"pharmacy-type"},et=(0,o._)("i",{class:"fa-solid fa-bars-progress"},null,-1),tt={class:"w-100 d-flex"},nt=(0,o.Uk)(" 快篩數量: ");function at(e,t,n,a,i,s){return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",Se,[(0,o._)("div",Ee,[(0,o._)("p",Ne,(0,O.zw)(n.item.name),1),(0,o._)("div",We,[Ye,(0,o._)("div",{class:"circle",onClick:t[0]||(t[0]=e=>{a.moveToPosition([n.item.latitude,n.item.longitude]),a.popUpMarker(n.index)})},Je)])]),(0,o._)("p",Ke,[Ve,(0,o._)("a",Fe,(0,O.zw)(n.item.telephone),1)]),(0,o._)("p",{class:"pharmacy-address",onClick:t[1]||(t[1]=e=>{a.moveToPosition([n.item.latitude,n.item.longitude]),a.popUpMarker(n.index)})},[Ge,(0,o.Uk)(" "+(0,O.zw)(n.item.address),1)]),(0,o._)("p",Qe,[Re,(0,o.Uk)(" "+(0,O.zw)(n.item.remark),1)]),(0,o._)("p",Xe,[et,(0,o.Uk)(" "+(0,O.zw)(n.item.brand),1)])]),(0,o._)("div",tt,[(0,o._)("div",{class:(0,O.C_)(["col-12 pharmacy-box",a.classColor(n.item.stock)])},[nt,(0,o._)("span",null,(0,O.zw)(n.item.stock),1)],2)])],64)}var ot={name:"quickList",props:["item","index"],setup(){function e(e){let t="";return t=e>=80?"bg-primary":e>=30?"bg-warning":e>=1?"bg-danger":"bg-secondary",t}return{classColor:e,moveToPosition:C,popUpMarker:x}}};const it=(0,He.Z)(ot,[["render",at]]);var st=it,rt={name:"sidebar",components:{"mask-list-component":Le,"quick-list-component":st},setup(){const e=(0,ge.yj)(),t=(0,ye.iH)(""),n=(0,y.v)(),{type:a,filterData:o,chooseCounty:i,chooseTown:s,quickData:r,slidebar:l}=(0,h.Jk)(n);function c(){n.reset(),U()}return a.value=e.name,{slidebar:l,filterData:o,changeType:c,type:a,title:t,chooseCounty:i,chooseTown:s,quickData:r}}};const lt=(0,He.Z)(rt,[["render",he]]);var ct=lt;n(4916),n(3948);const ut={class:"modal fade",id:"searchBox",tabindex:"-1",role:"dialog","aria-hidden":"true"},pt={class:"modal-dialog",role:"document"},dt={class:"modal-content"},mt=(0,o._)("div",{class:"modal-header"},[(0,o._)("h5",{class:"modal-title"},"搜尋條件"),(0,o._)("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[(0,o._)("span",{"aria-hidden":"true"},"×")])],-1),ft={class:"modal-body"},vt=(0,o._)("option",{class:"d-none",value:""},"請選擇縣市",-1),ht=["value"],yt=(0,o._)("option",{class:"d-none",value:""},"請選擇鄉鎮",-1),gt={key:0,value:"全區"},kt=["value"],bt={class:"modal-footer"},_t=(0,o._)("i",{class:"fa-solid fa-magnifying-glass"},null,-1),wt=[_t];function Ct(e,t,n,i,s,r){return(0,o.wg)(),(0,o.iD)("div",ut,[(0,o._)("div",pt,[(0,o._)("div",dt,[mt,(0,o._)("div",ft,[(0,o.wy)((0,o._)("select",{class:"form-control",onChange:t[0]||(t[0]=e=>i.changeCity(e.target.value)),"onUpdate:modelValue":t[1]||(t[1]=e=>i.cacheCounty=e)},[vt,((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.cityData,((e,t)=>((0,o.wg)(),(0,o.iD)("option",{value:e.CityName,key:t},(0,O.zw)(e.CityName),9,ht)))),128))],544),[[a.bM,i.cacheCounty]]),(0,o.wy)((0,o._)("select",{class:"form-control mt-3","onUpdate:modelValue":t[2]||(t[2]=e=>i.cacheTown=e)},[yt,""!=i.cacheCounty?((0,o.wg)(),(0,o.iD)("option",gt," 全區 ")):(0,o.kq)("",!0),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.townData,((e,t)=>((0,o.wg)(),(0,o.iD)("option",{value:e.AreaName,key:t},(0,O.zw)(e.AreaName),9,kt)))),128))],512),[[a.bM,i.cacheTown]])]),(0,o._)("div",bt,[(0,o._)("button",{type:"button",class:"btn btn-primary","data-dismiss":"modal",onClick:t[3]||(t[3]=(...e)=>i.search&&i.search(...e))},wt)])])])])}var xt={name:"search",setup(){const e=(0,y.v)(),{type:t,cityData:n,maskData:a,quickData:o,filterData:i,chooseCounty:s,cacheCounty:r,chooseTown:l,cacheTown:c}=(0,h.Jk)(e),u=(0,ye.iH)([]),p=((0,ye.iH)(""),(0,ye.iH)(""));function d(e){p.value="",n.value.find((t=>{t.CityName==e&&(u.value=t.AreaList)}))}function m(){U(),s.value=r.value,l.value=c.value;let e=[];"mask"==t.value?(e=a.value,""!=s.value&&(e=e.filter((e=>e.properties.county==s.value))),""!=l.value&&"全區"!=l.value&&(e=e.filter((e=>e.properties.town==l.value))),i.value=e,D(e)):(e=o.value,""!=s.value&&(e=e.filter((e=>e.address.indexOf(s.value)>-1))),""!=l.value&&"全區"!=l.value&&(e=e.filter((e=>e.address.indexOf(l.value)>-1))),i.value=e,T(e))}return{cityData:n,townData:u,cacheCounty:r,cacheTown:c,changeCity:d,search:m}}};const Dt=(0,He.Z)(xt,[["render",Ct]]);var Tt=Dt,Ut={name:"App",components:{"sidebar-component":ct,"search-component":Tt},setup(e){(0,o.bv)((async()=>{_(),w()}))}};const zt=(0,He.Z)(Ut,[["render",r]]);var Ot=zt;const $t=(0,ge.p7)({history:(0,ge.r5)("/prevention-map/"),routes:[{path:"/",name:"mask",component:()=>Promise.all([n.e(544),n.e(651)]).then(n.bind(n,1651))},{path:"/quick",name:"quick",component:()=>Promise.all([n.e(544),n.e(767)]).then(n.bind(n,8767))}]});var jt=$t;n(7154);const Pt=(0,a.ri)(Ot);Pt.use((0,h.WB)()),Pt.use(jt),jt.isReady().then((()=>Pt.mount("#app")))},3131:function(e,t,n){n.d(t,{v:function(){return o}});var a=n(3766);const o=(0,a.Q_)({id:"Data",state:()=>({type:"",maskData:[],quickData:[],filterData:[],cityData:[],chooseCounty:"",cacheCounty:"",chooseTown:"",cacheTown:"",slidebar:!1}),actions:{reset(){this.$state.slidebar=!0,"mask"==this.$state.type?this.$state.type="quick":this.$state.type="mask",this.$state.filterData=[],this.$state.chooseCounty="",this.$state.cacheCounty="",this.$state.chooseTown="",this.$state.cacheTown="",setTimeout((()=>{this.$state.slidebar=!1}),800)}}})}},t={};function n(a){var o=t[a];if(void 0!==o)return o.exports;var i=t[a]={exports:{}};return e[a].call(i.exports,i,i.exports,n),i.exports}n.m=e,function(){var e=[];n.O=function(t,a,o,i){if(!a){var s=1/0;for(u=0;u<e.length;u++){a=e[u][0],o=e[u][1],i=e[u][2];for(var r=!0,l=0;l<a.length;l++)(!1&i||s>=i)&&Object.keys(n.O).every((function(e){return n.O[e](a[l])}))?a.splice(l--,1):(r=!1,i<s&&(s=i));if(r){e.splice(u--,1);var c=o();void 0!==c&&(t=c)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[a,o,i]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,a){return n.f[a](e,t),t}),[]))}}(),function(){n.u=function(e){return"js/"+e+"."+{544:"0af07732",651:"72ed73a6",767:"16bbb999"}[e]+".js"}}(),function(){n.miniCssF=function(e){}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="prevention-map:";n.l=function(a,o,i,s){if(e[a])e[a].push(o);else{var r,l;if(void 0!==i)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var p=c[u];if(p.getAttribute("src")==a||p.getAttribute("data-webpack")==t+i){r=p;break}}r||(l=!0,r=document.createElement("script"),r.charset="utf-8",r.timeout=120,n.nc&&r.setAttribute("nonce",n.nc),r.setAttribute("data-webpack",t+i),r.src=a),e[a]=[o];var d=function(t,n){r.onerror=r.onload=null,clearTimeout(m);var o=e[a];if(delete e[a],r.parentNode&&r.parentNode.removeChild(r),o&&o.forEach((function(e){return e(n)})),t)return t(n)},m=setTimeout(d.bind(null,void 0,{type:"timeout",target:r}),12e4);r.onerror=d.bind(null,r.onerror),r.onload=d.bind(null,r.onload),l&&document.head.appendChild(r)}}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){n.p="/prevention-map/"}(),function(){var e={143:0};n.f.j=function(t,a){var o=n.o(e,t)?e[t]:void 0;if(0!==o)if(o)a.push(o[2]);else{var i=new Promise((function(n,a){o=e[t]=[n,a]}));a.push(o[2]=i);var s=n.p+n.u(t),r=new Error,l=function(a){if(n.o(e,t)&&(o=e[t],0!==o&&(e[t]=void 0),o)){var i=a&&("load"===a.type?"missing":a.type),s=a&&a.target&&a.target.src;r.message="Loading chunk "+t+" failed.\n("+i+": "+s+")",r.name="ChunkLoadError",r.type=i,r.request=s,o[1](r)}};n.l(s,l,"chunk-"+t,t)}},n.O.j=function(t){return 0===e[t]};var t=function(t,a){var o,i,s=a[0],r=a[1],l=a[2],c=0;if(s.some((function(t){return 0!==e[t]}))){for(o in r)n.o(r,o)&&(n.m[o]=r[o]);if(l)var u=l(n)}for(t&&t(a);c<s.length;c++)i=s[c],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(u)},a=self["webpackChunkprevention_map"]=self["webpackChunkprevention_map"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=n.O(void 0,[998],(function(){return n(2153)}));a=n.O(a)})();
//# sourceMappingURL=app.bc2e3e0c.js.map